<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Frame-Options" content="ALLOWALL">
    <title>TEST WEB OBJECT - Budget Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 650px !important;
            width: 100% !important;
            overflow: hidden !important;
            font-family: Arial, sans-serif;
            background: #f0f8ff;
        }

        .container {
            height: 650px !important;
            width: 100% !important;
            background: white;
            border: 3px solid #4a90e2;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: #4a90e2;
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
        }

        .content {
            flex: 1;
            padding: 15px;
            overflow: hidden;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            height: 400px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background: #f5f5f5;
            font-weight: bold;
            height: 30px;
        }

        td {
            height: 35px;
        }

        input {
            width: 100%;
            height: 30px;
            border: none;
            text-align: center;
            font-size: 11px;
            background: transparent;
        }

        input:focus {
            background: #e3f2fd;
            outline: 2px solid #4a90e2;
        }

        input[readonly] {
            background: #f5f5f5;
            font-weight: bold;
        }

        .section-header {
            background: #e3f2fd !important;
            font-weight: bold;
            color: #1565c0;
        }

        .total-row {
            background: #fff3e0 !important;
        }

        .net-row {
            background: #e8f5e8 !important;
            font-weight: bold;
        }

        .controls {
            height: 50px;
            background: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            border-top: 1px solid #ddd;
        }

        button {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-calc { background: #4a90e2; color: white; }
        .btn-clear { background: #dc3545; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            üìä TEST WEB OBJECT - Interactive Budget Spreadsheet (Fixed 650px Height)
        </div>

        <div class="content">
            <table>
                <thead>
                    <tr>
                        <th style="width: 25%;">Category</th>
                        <th style="width: 15%;">Jan</th>
                        <th style="width: 15%;">Feb</th>
                        <th style="width: 15%;">Mar</th>
                        <th style="width: 15%;">Total</th>
                        <th style="width: 15%;">Avg</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="section-header">
                        <td><strong>INCOME</strong></td>
                        <td></td><td></td><td></td><td></td><td></td>
                    </tr>
                    <tr>
                        <td>Salary</td>
                        <td><input type="number" data-row="1" data-col="1" placeholder="0"></td>
                        <td><input type="number" data-row="1" data-col="2" placeholder="0"></td>
                        <td><input type="number" data-row="1" data-col="3" placeholder="0"></td>
                        <td><input type="number" data-row="1" data-col="4" readonly></td>
                        <td><input type="number" data-row="1" data-col="5" readonly></td>
                    </tr>
                    <tr>
                        <td>Other Income</td>
                        <td><input type="number" data-row="2" data-col="1" placeholder="0"></td>
                        <td><input type="number" data-row="2" data-col="2" placeholder="0"></td>
                        <td><input type="number" data-row="2" data-col="3" placeholder="0"></td>
                        <td><input type="number" data-row="2" data-col="4" readonly></td>
                        <td><input type="number" data-row="2" data-col="5" readonly></td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>Total Income</strong></td>
                        <td><input type="number" data-row="3" data-col="1" readonly></td>
                        <td><input type="number" data-row="3" data-col="2" readonly></td>
                        <td><input type="number" data-row="3" data-col="3" readonly></td>
                        <td><input type="number" data-row="3" data-col="4" readonly></td>
                        <td><input type="number" data-row="3" data-col="5" readonly></td>
                    </tr>
                    
                    <tr class="section-header">
                        <td><strong>EXPENSES</strong></td>
                        <td></td><td></td><td></td><td></td><td></td>
                    </tr>
                    <tr>
                        <td>Housing</td>
                        <td><input type="number" data-row="4" data-col="1" placeholder="0"></td>
                        <td><input type="number" data-row="4" data-col="2" placeholder="0"></td>
                        <td><input type="number" data-row="4" data-col="3" placeholder="0"></td>
                        <td><input type="number" data-row="4" data-col="4" readonly></td>
                        <td><input type="number" data-row="4" data-col="5" readonly></td>
                    </tr>
                    <tr>
                        <td>Food</td>
                        <td><input type="number" data-row="5" data-col="1" placeholder="0"></td>
                        <td><input type="number" data-row="5" data-col="2" placeholder="0"></td>
                        <td><input type="number" data-row="5" data-col="3" placeholder="0"></td>
                        <td><input type="number" data-row="5" data-col="4" readonly></td>
                        <td><input type="number" data-row="5" data-col="5" readonly></td>
                    </tr>
                    <tr>
                        <td>Transportation</td>
                        <td><input type="number" data-row="6" data-col="1" placeholder="0"></td>
                        <td><input type="number" data-row="6" data-col="2" placeholder="0"></td>
                        <td><input type="number" data-row="6" data-col="3" placeholder="0"></td>
                        <td><input type="number" data-row="6" data-col="4" readonly></td>
                        <td><input type="number" data-row="6" data-col="5" readonly></td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>Total Expenses</strong></td>
                        <td><input type="number" data-row="7" data-col="1" readonly></td>
                        <td><input type="number" data-row="7" data-col="2" readonly></td>
                        <td><input type="number" data-row="7" data-col="3" readonly></td>
                        <td><input type="number" data-row="7" data-col="4" readonly></td>
                        <td><input type="number" data-row="7" data-col="5" readonly></td>
                    </tr>
                    
                    <tr class="net-row">
                        <td><strong>NET INCOME</strong></td>
                        <td><input type="number" data-row="8" data-col="1" readonly></td>
                        <td><input type="number" data-row="8" data-col="2" readonly></td>
                        <td><input type="number" data-row="8" data-col="3" readonly></td>
                        <td><input type="number" data-row="8" data-col="4" readonly></td>
                        <td><input type="number" data-row="8" data-col="5" readonly></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="controls">
            <button class="btn-calc" onclick="calculate()">üìä Calculate</button>
            <button class="btn-clear" onclick="clearAll()">üóëÔ∏è Clear</button>
        </div>
    </div>

    <script>
        function calculate() {
            // Calculate for each month and totals
            for (let col = 1; col <= 5; col++) {
                // Income totals
                const salary = parseFloat(document.querySelector(`[data-row="1"][data-col="${col}"]`).value) || 0;
                const otherIncome = parseFloat(document.querySelector(`[data-row="2"][data-col="${col}"]`).value) || 0;
                const totalIncome = salary + otherIncome;
                document.querySelector(`[data-row="3"][data-col="${col}"]`).value = totalIncome.toFixed(2);
                
                // Expense totals
                const housing = parseFloat(document.querySelector(`[data-row="4"][data-col="${col}"]`).value) || 0;
                const food = parseFloat(document.querySelector(`[data-row="5"][data-col="${col}"]`).value) || 0;
                const transport = parseFloat(document.querySelector(`[data-row="6"][data-col="${col}"]`).value) || 0;
                const totalExpenses = housing + food + transport;
                document.querySelector(`[data-row="7"][data-col="${col}"]`).value = totalExpenses.toFixed(2);
                
                // Net income
                const netIncome = totalIncome - totalExpenses;
                const netCell = document.querySelector(`[data-row="8"][data-col="${col}"]`);
                netCell.value = netIncome.toFixed(2);
                netCell.style.color = netIncome >= 0 ? '#2e7d32' : '#c62828';
            }
            
            // Calculate row totals and averages
            for (let row = 1; row <= 8; row++) {
                let total = 0;
                for (let col = 1; col <= 3; col++) {
                    total += parseFloat(document.querySelector(`[data-row="${row}"][data-col="${col}"]`).value) || 0;
                }
                document.querySelector(`[data-row="${row}"][data-col="4"]`).value = total.toFixed(2);
                document.querySelector(`[data-row="${row}"][data-col="5"]`).value = (total / 3).toFixed(2);
            }
        }

        function clearAll() {
            document.querySelectorAll('input:not([readonly])').forEach(input => input.value = '');
            calculate();
        }

        // Auto-calculate on input
        document.addEventListener('input', function(e) {
            if (e.target.type === 'number' && !e.target.readOnly) {
                setTimeout(calculate, 10);
            }
        });

        // Initialize with sample data
        document.querySelector('[data-row="1"][data-col="1"]').value = '4000';
        document.querySelector('[data-row="1"][data-col="2"]').value = '4200';
        document.querySelector('[data-row="1"][data-col="3"]').value = '4100';
        document.querySelector('[data-row="4"][data-col="1"]').value = '1200';
        document.querySelector('[data-row="4"][data-col="2"]').value = '1200';
        document.querySelector('[data-row="4"][data-col="3"]').value = '1250';
        calculate();
    </script>
</body>
</html>
